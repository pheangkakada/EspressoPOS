<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - POS System</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="admin.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

    <div class="admin-container">
        <aside class="admin-sidebar">
            <div class="admin-sidebar-header">
                <h2>
                    <span class="material-icons-round">admin_panel_settings</span>
                    Admin Panel
                </h2>
            </div>

            <nav class="admin-sidebar-nav">
                <div class="admin-nav-section">
                    <div class="admin-nav-title">Main</div>
                    <div class="admin-nav-item active" data-page="dashboard" onclick="navigateTo('dashboard')">
                        <span class="material-icons-round">dashboard</span>
                        <span>Dashboard</span>
                    </div>
                </div>

                <div class="admin-nav-section">
                    <div class="admin-nav-title">Menu Management</div>
                    <div class="admin-nav-item" data-page="menu-items" onclick="navigateTo('menu-items')">
                        <span class="material-icons-round">restaurant_menu</span>
                        <span>Menu Items</span>
                    </div>
                    <div class="admin-nav-item" data-page="categories" onclick="navigateTo('categories')">
                        <span class="material-icons-round">category</span>
                        <span>Categories</span>
                    </div>
                </div>
                
                <div class="admin-nav-section">
                    <div class="admin-nav-title">Sales & Orders</div>
                    <div class="admin-nav-item" data-page="invoices" onclick="navigateTo('invoices')">
                        <span class="material-icons-round">receipt_long</span>
                        <span>Invoices</span>
                    </div>
                    <div class="admin-nav-item" data-page="sales" onclick="navigateTo('sales')">
                        <span class="material-icons-round">trending_up</span>
                        <span>Sales Reports</span>
                    </div>
                </div>

                <div class="admin-nav-section">
                    <div class="admin-nav-title">System</div>
                    <div class="admin-nav-item" data-page="users" onclick="navigateTo('users')">
                        <span class="material-icons-round">people</span>
                        <span>Users</span>
                    </div>
                    <div class="admin-nav-item" data-page="settings" onclick="navigateTo('settings')">
                        <span class="material-icons-round">settings</span>
                        <span>Settings</span>
                    </div>
                </div>
            </nav>

            <div class="admin-sidebar-footer">
                <button class="admin-logout-btn" onclick="logout()">
                    <span class="material-icons-round">logout</span>
                    Logout
                </button>
            </div>
        </aside>

        <main class="admin-main-content">
            <header class="admin-header">
                <div style="display: flex; align-items: center; gap: 15px;">
                    <button class="admin-mobile-toggle" onclick="toggleSidebar()">
                        <span class="material-icons-round">menu</span>
                    </button>
                    <h1 id="page-title">Dashboard Overview</h1>
                </div>

                <div class="admin-header-actions">
                    <div class="admin-datetime">
                        <span id="current-date">Loading...</span>
                        <span id="current-time">Loading...</span>
                    </div>
                </div>
            </header>

            <div id="dynamic-content">
                <div id="dashboard-page">
                    <div class="admin-dashboard-stats">
                        <div class="admin-stat-card">
                            <span class="material-icons-round admin-stat-icon" style="background:#E3F2FD; color:#1565C0;">receipt</span>
                            <div class="admin-stat-value" id="stat-total-orders">0</div>
                            <div class="admin-stat-label">Total Orders</div>
                        </div>
                        <div class="admin-stat-card">
                            <span class="material-icons-round admin-stat-icon" style="background:#E8F5E9; color:#2E7D32;">payments</span>
                            <div class="admin-stat-value" id="stat-total-revenue">$0.00</div>
                            <div class="admin-stat-label">Total Revenue</div>
                        </div>
                        <div class="admin-stat-card">
                            <span class="material-icons-round admin-stat-icon" style="background:#FFF3E0; color:#EF6C00;">restaurant</span>
                            <div class="admin-stat-value" id="stat-menu-items">0</div>
                            <div class="admin-stat-label">Menu Items</div>
                        </div>
                    </div>

                    <div class="admin-table-container">
                        <div class="admin-table-header">
                            <div class="admin-table-title">Recent Orders</div>
                            <button class="btn-admin btn-admin-primary" onclick="navigateTo('invoices')">View All</button>
                        </div>
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Table</th>
                                    <th>Amount</th>
                                    <th>Status</th>
                                    <th>Time</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="recent-orders-body">
                                </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <div id="add-user-modal" class="admin-modal hidden">
        <div class="admin-modal-content">
            <div class="admin-modal-header">
                <h3 class="admin-modal-title">Manage User</h3>
                <button class="admin-modal-close" onclick="hideModal('add-user-modal')">
                    <span class="material-icons-round">close</span>
                </button>
            </div>
            <div class="admin-modal-body">
                <form id="add-user-form">
                    <input type="hidden" id="edit-user-id">
                    <div class="admin-form-group">
                        <label class="admin-form-label">Full Name</label>
                        <input type="text" id="user-fullname" class="admin-form-control" required>
                    </div>
                    <div class="admin-form-group">
                        <label class="admin-form-label">Operator ID (Username)</label>
                        <input type="text" id="user-username" class="admin-form-control" required>
                    </div>
                    <div class="admin-form-group">
                        <label class="admin-form-label">Security PIN (4 Digits)</label>
                        <input type="text" id="user-pin" class="admin-form-control" maxlength="4" pattern="\d{4}">
                        <small style="color: #666; font-size: 12px;">Leave blank to keep current PIN when editing.</small>
                    </div>
                    <div class="admin-form-group">
                        <label class="admin-form-label">Role</label>
                        <select id="user-role" class="admin-form-control">
                            <option value="cashier">Cashier</option>
                            <option value="manager">Manager</option>
                            <option value="admin">Admin</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="admin-modal-footer">
                <button class="btn-admin btn-admin-secondary" onclick="hideModal('add-user-modal')">Cancel</button>
                <button class="btn-admin btn-admin-primary" onclick="saveUser()">Save User</button>
            </div>
        </div>
    </div>

    <div id="add-menu-item-modal" class="admin-modal hidden">
        <div class="admin-modal-content modal-large">
             <div class="admin-modal-header">
                <h3 class="admin-modal-title">Add Menu Item</h3>
                <button class="admin-modal-close" onclick="hideModal('add-menu-item-modal')">
                    <span class="material-icons-round">close</span>
                </button>
            </div>
            <div class="admin-modal-body">
                <form id="menu-item-form" class="item-form-grid">
                    <input type="hidden" id="edit-menu-item-id">
                    
                    <div class="form-section-image">
                        <div class="image-preview-box">
                            <img id="image-preview-img" src="" class="hidden">
                            <div id="image-preview-placeholder">Preview</div>
                        </div>
                        <div class="admin-form-group">
                            <label class="admin-form-label">Image URL</label>
                            <input type="text" id="item-image" class="admin-form-control" oninput="updateImagePreview(this.value)">
                        </div>
                    </div>

                    <div class="form-section-details">
                         <div class="admin-form-group">
                            <label class="admin-form-label">Name</label>
                            <input type="text" id="item-name" class="admin-form-control" required>
                        </div>
                        <div class="admin-form-group">
                            <label class="admin-form-label">Price ($)</label>
                            <input type="number" id="item-price" class="admin-form-control" step="0.01" required>
                        </div>
                        <div class="admin-form-group">
                            <label class="admin-form-label">Type</label>
                            <input type="text" id="item-type" class="admin-form-control" placeholder="Hot, Cold, etc">
                        </div>
                         <div style="display:flex; gap:20px; margin-top:10px;">
                            <label class="toggle-switch-container">
                                Active <input type="checkbox" id="item-is-active" checked>
                            </label>
                            <label class="toggle-switch-container">
                                Promo <input type="checkbox" id="item-is-promo">
                            </label>
                        </div>
                        
                        <div id="promo-fields" class="hidden" style="margin-top:10px;">
                            <div class="admin-form-group">
                                <label class="admin-form-label">Promo Price</label>
                                <input type="number" id="item-promo-price" class="admin-form-control">
                            </div>
                            <div class="admin-form-group">
                                <label class="admin-form-label">Badge</label>
                                <input type="text" id="item-promo-badge" class="admin-form-control">
                            </div>
                        </div>

                         <div class="admin-form-group" style="margin-top:15px;">
                            <label class="admin-form-label">Categories (Select)</label>
                            <div id="category-chips-container" class="category-chips-wrapper"></div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="admin-modal-footer">
                <button class="btn-admin btn-admin-secondary" onclick="hideModal('add-menu-item-modal')">Cancel</button>
                <button class="btn-admin btn-admin-primary" onclick="saveMenuItem()">Save Item</button>
            </div>
        </div>
    </div>
    
    <div id="invoiceDetailModal" class="admin-modal hidden">
        <div class="admin-modal-content modal-small">
            </div>
    </div>

    <script src="admin.js"></script>
</body>
</html>